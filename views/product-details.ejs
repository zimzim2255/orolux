<!DOCTYPE html>
<html lang="en">
<head>
  
  <title><%= product.name %> | OROLUX</title>
  <%- include('partials/head') %>
  <style>
    .product-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 8rem 2rem 4rem;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 4rem;
    }

    @media (max-width: 768px) {
      .product-container {
        grid-template-columns: 1fr;
        padding: 6rem 1.5rem 3rem;
        gap: 2rem;
      }
    }

    .product-image {
      width: 100%;
      aspect-ratio: 1;
      overflow: hidden;
      background: var(--deep-blue);
      border-radius: 2px;
    }

    .product-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.7s ease;
    }

    .product-image:hover img {
      transform: scale(1.05);
    }

    .product-details {
      padding: 2rem 0;
    }

    .product-name {
      font-family: 'Cormorant Garamond', serif;
      font-size: 2.5rem;
      font-weight: 300;
      color: var(--deep-blue);
      margin-bottom: 1rem;
      letter-spacing: 1px;
    }

    .product-price {
      font-family: 'Montserrat', sans-serif;
      font-size: 1.5rem;
      color: var(--deep-blue);
      margin-bottom: 2rem;
      font-weight: 300;
    }

    .product-description {
      font-family: 'Montserrat', sans-serif;
      font-size: 1rem;
      line-height: 1.8;
      color: rgba(10, 36, 64, 0.8);
      margin-bottom: 2.5rem;
    }

    .add-to-cart-form {
      margin-bottom: 2rem;
    }

    .quantity-label {
      display: block;
      font-family: 'Montserrat', sans-serif;
      font-size: 0.9rem;
      color: var(--deep-blue);
      margin-bottom: 0.5rem;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .quantity-input {
      width: 100px;
      padding: 0.75rem;
      border: 1px solid var(--gold);
      border-radius: 2px;
      margin-bottom: 1.5rem;
      font-family: 'Montserrat', sans-serif;
      color: var(--deep-blue);
    }

    .add-to-cart-btn {
      display: inline-block;
      padding: 1rem 2.5rem;
      background-color: var(--deep-blue);
      color: var(--cream);
      border: none;
      border-radius: 2px;
      font-family: 'Montserrat', sans-serif;
      font-size: 0.9rem;
      text-transform: uppercase;
      letter-spacing: 1px;
      cursor: pointer;
      transition: all 0.3s ease;
    }    .add-to-cart-btn:hover {
      background-color: var(--gold);
      transform: translateY(-2px);
    }

    .product-actions {
      display: flex;
      gap: 1rem;
      align-items: center;
      margin-bottom: 2rem;
    }

    .wishlist-btn {
      display: inline-flex;
      align-items: center;
      padding: 1rem 2.5rem;
      background-color: transparent;
      color: var(--deep-blue);
      border: 1px solid var(--deep-blue);
      border-radius: 2px;
      font-family: 'Montserrat', sans-serif;
      font-size: 0.9rem;
      text-transform: uppercase;
      letter-spacing: 1px;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
    }

    .wishlist-btn:hover {
      background-color: var(--deep-blue);
      color: var(--cream);
      transform: translateY(-2px);
    }

    .wishlist-btn svg, .add-to-cart-btn svg {
      width: 1.25rem;
      height: 1.25rem;
      margin-right: 0.5rem;
    }

    @media (max-width: 768px) {
      .product-actions {
        flex-direction: column;
        gap: 1rem;
      }

      .add-to-cart-btn, .wishlist-btn {
        width: 100%;
        justify-content: center;
      }
    }

    .comments-section {
      margin-top: 4rem;
      padding-top: 3rem;
      border-top: 1px solid var(--gold);
    }

    .comments-title {
      font-family: 'Cormorant Garamond', serif;
      font-size: 2rem;
      font-weight: 300;
      color: var(--deep-blue);
      margin-bottom: 2rem;
      letter-spacing: 1px;
    }

    .comment {
      padding: 1.5rem;
      background: rgba(180, 196, 214, 0.1);
      border-radius: 2px;
      margin-bottom: 1.5rem;
    }

    .comment-username {
      font-family: 'Montserrat', sans-serif;
      font-weight: 500;
      color: var(--deep-blue);
      margin-bottom: 0.5rem;
    }

    .comment-text {
      font-family: 'Montserrat', sans-serif;
      color: rgba(10, 36, 64, 0.8);
      line-height: 1.6;
    }

    .comment-date {
      font-family: 'Montserrat', sans-serif;
      font-size: 0.8rem;
      color: rgba(10, 36, 64, 0.6);
      margin-top: 0.5rem;
    }

    .comment-form {
      margin-top: 3rem;
    }

    .comment-form-title {
      font-family: 'Cormorant Garamond', serif;
      font-size: 1.5rem;
      font-weight: 300;
      color: var(--deep-blue);
      margin-bottom: 1.5rem;
      letter-spacing: 1px;
    }

    .comment-input {
      width: 100%;
      padding: 1rem;
      margin-bottom: 1rem;
      border: 1px solid var(--gold);
      border-radius: 2px;
      font-family: 'Montserrat', sans-serif;
    }

    .comment-textarea {
      width: 100%;
      padding: 1rem;
      margin-bottom: 1.5rem;
      border: 1px solid var(--gold);
      border-radius: 2px;
      font-family: 'Montserrat', sans-serif;
      min-height: 120px;
    }

    .back-link {
      display: inline-block;
      margin-top: 2rem;
      color: var(--deep-blue);
      text-decoration: none;
      font-family: 'Montserrat', sans-serif;
      font-size: 0.9rem;
      text-transform: uppercase;
      letter-spacing: 1px;
      transition: color 0.3s ease;
    }

    .back-link:hover {
      color: var(--gold);
    }
  </style>
</head>
<body class="font-sans antialiased">
  <%- include('partials/header') %>
  
  <div class="product-container">
    <!-- Product Image -->
    <div class="product-image">
        <img src="<%= product.image %>" 
             alt="<%= product.name %>"
             loading="lazy">
    </div>

    <!-- Product Details -->
    <div class="product-details">
      <h1 class="product-name"><%= product.name %></h1>
      <p class="product-price"><%= product.price.toLocaleString() %> DH</p>
      <p class="product-description"><%= product.description %></p>      <form action="/cart/add" method="POST" class="add-to-cart-form">
        <input type="hidden" name="productId" value="<%= product._id %>">
        <label class="quantity-label">Quantity</label>
        <input type="number" name="quantity" value="1" min="1" class="quantity-input">
        <div class="product-actions">
          <button type="submit" class="add-to-cart-btn">
            <svg class="w-5 h-5 mr-2 inline-block" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z" />
            </svg>
            Add to Cart
          </button>
          <a href="/wishlist/add/<%= product._id %>" class="wishlist-btn">
            <svg class="w-5 h-5 mr-2 inline-block" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" />
            </svg>
            Add to Wishlist
          </a>
        </div>
      </form>

      <!-- Comments Section -->
      <div class="comments-section">
        <h3 class="comments-title">Customer Reviews</h3>
        
        <% if (product.comments && product.comments.length > 0) { %>
          <% product.comments.forEach(comment => { %>
            <div class="comment">
              <p class="comment-username"><%= comment.username %></p>
              <p class="comment-text"><%= comment.text %></p>
              <p class="comment-date"><%= new Date(comment.createdAt).toLocaleString() %></p>
            </div>
          <% }) %>
        <% } else { %>
          <p class="comment-text">No reviews yet. Be the first to review this timepiece.</p>
        <% } %>

        <!-- Comment Form -->
        <div class="comment-form">
          <h4 class="comment-form-title">Write a Review</h4>
          <form action="/product/<%= product._id %>/add-comment" method="POST">
            <input type="text" name="username" placeholder="Your Name" required class="comment-input">
            <textarea name="text" placeholder="Your Review" required class="comment-textarea"></textarea>
            <button type="submit" class="add-to-cart-btn">Submit Review</button>
          </form>
        </div>
      </div>

      <a href="/products" class="back-link">â¬… Back to Collection</a>
    </div>
  </div>

  <%- include('partials/footer') %>
</body>
</html>